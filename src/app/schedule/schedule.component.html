<div class="header">
    <health-calendar-header [(view)]="view" (viewDateChange)="selectToday($event)" [(viewDate)]="viewDate">
    </health-calendar-header>
</div>
<div class="schedule">
    <mwl-calendar-month-view [weekStartsOn]="weekStartsOn" [locale]="locale" [viewDate]="viewDate" [events]="events" [activeDayIsOpen]="activeDayIsOpen"
        [openDayEventsTemplate]="customOneDayViewTemplate" [dayModifier]="selectDay" (dayClicked)="dayClicked($event.day)">
    </mwl-calendar-month-view>
</div>

<ng-template #customOneDayViewTemplate>
    <div class="container">
        <div class="left">
            <div class="date">{{viewDate | dateTimeFormat}}</div>
            <div class="list">
                <health-event [role]="user?.role" [event]="event" (onEditEvent)="edit($event)" (onDeleteEvent)="delete($event)" *ngFor="let event of oneDayEvents"></health-event>
            </div>
        </div>
        <div class="right" *ngIf="isAuth">
            <div *ngIf="isAdmin && editAppointment">
                редактирование
            </div>
            <div *ngIf="isAdmin && !editAppointment">
                добавить нового
                <input auto-complete [list-formatter]="listFormatter" [value-formatter]="valueFormatter" [match-formatted]="matchFormatted"
                    [(ngModel)]="clientName" [no-match-found-text]="noMatchFoundText" (valueChanged)="onValueChanged($event)"
                    [source]="allClients" />
            </div>
            <div class="info">Введите удобное для Вас время</div>
            <div class="time" [formGroup]="newAppointmentForm">
                <input type="text" formControlName="start" [textMask]="{mask: mask(newAppointmentForm.value.start), keepCharPositions:true}"
                    (focusout)="onFocusOut(true)" placeholder="00:00">
                <input type="text" formControlName="end" [textMask]="{mask: mask(newAppointmentForm.value.end), keepCharPositions:true}"
                    (focusout)="onFocusOut(false)" placeholder="00:00">
            </div>
            <div class="info" *ngIf="timeValidation">{{timeValidation}}</div>
            <div class="pay">
                <label><input type="checkbox" id="pay" [checked]="payed" (change)="payed = !payed">Оплатить</label>
            </div>
            <div class="button" (click)="addEvent()" [ngClass]="{disabled: !allowToSaveEvent}">
                <div>Записаться</div>
            </div>
        </div>
    </div>
</ng-template>

<!--<div class="schedule">

</div>
<ng-template #customOneDayViewTemplate>
    <div class="one-day-box">
        <div class="appointment-box" *ngIf="isAuth">
        </div>
        <ng-template #appointment>
            <div class="appointment">
                <div class="clients-box" *ngIf="isAdmin && !editAppointment">
                    <div>
                        Выберите клиента
                    </div>
                    <input auto-complete [list-formatter]="listFormatter" [value-formatter]="valueFormatter" [match-formatted]="matchFormatted"
                        [(ngModel)]="clientName" [no-match-found-text]="noMatchFoundText" (valueChanged)="onValueChanged($event)"
                        [source]="allClients" />
                </div>
                <div class="clients-box" *ngIf="isAdmin && editAppointment">
                    <div>Вы редактируете {{editEvent?.start | timeFormat}} - {{editEvent?.end | timeFormat}} {{editEvent?.title}}</div>
                </div>
                <div class="info-box" *ngIf="!isAdmin">Введите удобное для Вас время приёма</div>
                <div class="time-box" [formGroup]="newAppointmentForm">
                    <div class="start-time">
                        <input type="text" formControlName="start" [textMask]="{mask: mask(newAppointmentForm.value.start), keepCharPositions:true}"
                            (focusout)="onFocusOut(true)" placeholder="00:00">
                    </div>
                    <div class="end-time">
                        <input type="text" formControlName="end" [textMask]="{mask: mask(newAppointmentForm.value.end), keepCharPositions:true}"
                            (focusout)="onFocusOut(false)" placeholder="00:00">
                    </div>
                </div>
                <div class="error-box">
                    <div class="error">{{timeValidation}}</div>
                </div>
                <div class="pay-box" *ngIf="!isAdmin">
                    <label><input type="checkbox" id="pay" [checked]="payed" (change)="payed = !payed">Оплатить</label>
                </div>
                <div class="info-box" *ngIf="!payed && !isAdmin">Чтобы продолжить Вам необхдимо оплатить приём</div>
                <div class="control-box">
                    <div class="control-button" (click)="addEvent()" [ngClass]="{disabled: !allowToSaveEvent}">
                        <div>Записаться</div>
                    </div>
                    <div class="control-button" (click)="cancel()">
                        <div>Отмена</div>
                    </div>
                </div>
            </div>
        </ng-template>
    </div>
</ng-template>-->